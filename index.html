<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Car Dealership VR</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script>

    AFRAME.registerComponent('rotate-y', {
      schema: { speed: { type: 'number', default: 0.3 } },
      tick: function (time, delta) {
        this.el.object3D.rotation.y += THREE.MathUtils.degToRad(this.data.speed) * (delta / 1000) * 60;
      }
    });

    AFRAME.registerComponent('gaze-body', {
      schema: { duration: { type: 'number', default: 350 } },
      init: function () {
        this._s = 0; this._t = 0;
        this.el.object3D.scale.set(0, 0, 0);
        this.el.addEventListener('mouseenter', () => { this._t = 1; });
        this.el.addEventListener('mouseleave', () => { this._t = 0; });
      },
      tick: function (time, delta) {
        if (Math.abs(this._s - this._t) < 0.005) {
          this._s = this._t;
          this.el.object3D.scale.setScalar(this._s);
          return;
        }
        this._s += (this._t - this._s) * Math.min((delta / this.data.duration) * 5, 1);
        this.el.object3D.scale.setScalar(this._s);
      }
    });

    </script>
  </head>
  <body>
    <a-scene
      background="color: #e8e8e8"
      vr-mode-ui="enabled: true"
      renderer="antialias: true; colorManagement: true"
    >

      <!-- ═══ ASSETS ══════════════════════════════════════════════════════════ -->
      <a-assets timeout="30000">
        <a-asset-item id="auto"        src="macchina_test.glb"></a-asset-item>
        <!-- Kenney Furniture Kit — CC0 — cdn.poly.pizza -->
        <a-asset-item id="sofa"        src="https://cdn.poly.pizza/m/f47310a0-4d22-48a3-a2ce-62f67bcc998d/model.glb"></a-asset-item>
        <a-asset-item id="sofa-corner" src="https://cdn.poly.pizza/m/e78c10a3-58e6-400b-a576-c5db78c2d30f/model.glb"></a-asset-item>
        <a-asset-item id="chair"       src="https://cdn.poly.pizza/m/36331876-a6da-4a91-9788-ac78650dd891/model.glb"></a-asset-item>
        <a-asset-item id="table"       src="https://cdn.poly.pizza/m/68c4bcbd-0c5d-42ee-ab91-4cce6672fa18/model.glb"></a-asset-item>
        <a-asset-item id="plant"       src="https://cdn.poly.pizza/m/b892ee12-370d-4dae-aa14-d377b89f9413/model.glb"></a-asset-item>
        <a-asset-item id="plant-pot"   src="https://cdn.poly.pizza/m/6482596c-6423-415d-bfd5-e66bcc546642/model.glb"></a-asset-item>
        <a-asset-item id="lamp"        src="https://cdn.poly.pizza/m/98dd45a1-0682-4d44-83d1-32fa2a4fca5b/model.glb"></a-asset-item>
        <a-asset-item id="desk"        src="https://cdn.poly.pizza/m/0716218b-3aae-48e6-8ddd-185cf7f7b7d7/model.glb"></a-asset-item>
        <a-asset-item id="desk-chair"  src="https://cdn.poly.pizza/m/64699642-a4c2-4850-9c4b-558a328ed1bf/model.glb"></a-asset-item>
      </a-assets>

      <!-- ═══ LUCI ════════════════════════════════════════════════════════════ -->
      <a-light type="ambient"     color="#ffffff" intensity="0.9"></a-light>
      <a-light type="directional" position="3 8 2"  color="#fff8f0" intensity="0.8"></a-light>
      <a-light type="directional" position="-3 6 -2" color="#f0f4ff" intensity="0.4"></a-light>
      <!-- Spot sulla macchina -->
      <a-light type="spot" position="0 7 -5" color="#ffffff" intensity="4" angle="25" penumbra="0.5"></a-light>
      <!-- Luci calde zona attesa -->
      <a-light type="point" position="-7 3 2"  color="#ffe0a0" intensity="1.5" distance="8"></a-light>
      <a-light type="point" position="-7 3 -2" color="#ffe0a0" intensity="1.2" distance="7"></a-light>
      <!-- Accent blu sulla piattaforma -->
      <a-light type="point" position="0 -0.3 -5" color="#aaccff" intensity="1.2" distance="4"></a-light>

      <!-- ═══ SHOWROOM ══════════════════════════════════════════════════════════
           Concessionaria moderna: pareti bianche/grigio chiaro, pavimento lucido,
           vetrate simulate, zona attesa con divani, banco reception
      ══════════════════════════════════════════════════════════════════════════ -->

      <!-- Pavimento lucido bianco -->
      <a-plane position="0 -0.51 -3" rotation="-90 0 0" width="28" height="22"
        color="#f0f0f0" material="metalness:0.4; roughness:0.1"></a-plane>

      <!-- Strisce pavimento decorative grigio -->
      <a-box position="0 -0.505 -3"    width="28"  height="0.001" depth="0.04" color="#cccccc"></a-box>
      <a-box position="0 -0.505 -5"    width="28"  height="0.001" depth="0.04" color="#cccccc"></a-box>
      <a-box position="0 -0.505 -8"    width="28"  height="0.001" depth="0.04" color="#cccccc"></a-box>
      <a-box position="4 -0.505 -3"    width="0.04" height="0.001" depth="22"  color="#cccccc"></a-box>
      <a-box position="-4 -0.505 -3"   width="0.04" height="0.001" depth="22"  color="#cccccc"></a-box>

      <!-- Pareti bianche -->
      <!-- Parete frontale (vetrata simulata) -->
      <a-plane position="0 4 -14" rotation="0 0 0" width="28" height="10" color="#f5f5f5" material="roughness:1"></a-plane>
      <!-- Montanti vetrata frontale -->
      <a-box position="-6 4 -13.95"  width="0.15" height="10" depth="0.1" color="#888888"></a-box>
      <a-box position=" 0 4 -13.95"  width="0.15" height="10" depth="0.1" color="#888888"></a-box>
      <a-box position=" 6 4 -13.95"  width="0.15" height="10" depth="0.1" color="#888888"></a-box>
      <a-box position="-12 4 -13.95" width="0.15" height="10" depth="0.1" color="#888888"></a-box>
      <a-box position=" 12 4 -13.95" width="0.15" height="10" depth="0.1" color="#888888"></a-box>
      <!-- Traversa orizzontale -->
      <a-box position="0 2 -13.95" width="28" height="0.1" depth="0.1" color="#888888"></a-box>
      <a-box position="0 6 -13.95" width="28" height="0.1" depth="0.1" color="#888888"></a-box>
      <!-- Vetro simulato (pannelli azzurrognoli semitrasparenti) -->
      <a-plane position="-9 4 -13.9" rotation="0 0 0" width="5.7" height="7.8" material="color:#c8e0ff; opacity:0.18; transparent:true; side:double"></a-plane>
      <a-plane position="-3 4 -13.9" rotation="0 0 0" width="5.7" height="7.8" material="color:#c8e0ff; opacity:0.18; transparent:true; side:double"></a-plane>
      <a-plane position=" 3 4 -13.9" rotation="0 0 0" width="5.7" height="7.8" material="color:#c8e0ff; opacity:0.18; transparent:true; side:double"></a-plane>
      <a-plane position=" 9 4 -13.9" rotation="0 0 0" width="5.7" height="7.8" material="color:#c8e0ff; opacity:0.18; transparent:true; side:double"></a-plane>

      <!-- Parete destra (divisore area admin) -->
      <a-plane position="12 4 -3" rotation="0 -90 0" width="22" height="10" color="#f0f0f0" material="roughness:1"></a-plane>

      <!-- Parete sinistra — insegna concessionaria -->
      <a-plane position="-12 4 -3" rotation="0 90 0" width="22" height="10" color="#f0f0f0" material="roughness:1"></a-plane>
      <!-- Logo/insegna sulla parete sinistra -->
      <a-box  position="-11.9 6.5 -3" width="0.05" height="0.8" depth="7" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:0.4"></a-box>
      <a-text value="AUTO SHOWROOM" rotation="0 90 0" position="-11.85 6.5 -3" color="#cc0000" width="5" align="center" wrap-count="16"></a-text>
      <a-text value="PREMIUM SELECTION" rotation="0 90 0" position="-11.85 5.8 -3" color="#555555" width="3.5" align="center" wrap-count="20"></a-text>

      <!-- Parete posteriore -->
      <a-plane position="0 4 5" rotation="0 180 0" width="28" height="10" color="#f0f0f0" material="roughness:1"></a-plane>

      <!-- Soffitto bianco con travi a vista -->
      <a-plane position="0 9 -3" rotation="90 0 0" width="28" height="22" color="#ffffff" material="roughness:1"></a-plane>
      <!-- Travi soffitto -->
      <a-box position="-8 8.8 -3"  width="0.3" height="0.4" depth="22" color="#e0e0e0"></a-box>
      <a-box position=" 8 8.8 -3"  width="0.3" height="0.4" depth="22" color="#e0e0e0"></a-box>
      <!-- Strisce LED a soffitto (moderne, bianche) -->
      <a-box position="-3 8.95 -3" width="0.12" height="0.08" depth="18" color="#ffffff" material="emissive:#ffffff; emissiveIntensity:1.5; opacity:1"></a-box>
      <a-box position=" 3 8.95 -3" width="0.12" height="0.08" depth="18" color="#ffffff" material="emissive:#ffffff; emissiveIntensity:1.5; opacity:1"></a-box>
      <a-box position=" 0 8.95 -3" width="0.08" height="0.06" depth="18" color="#ffffff" material="emissive:#ffffff; emissiveIntensity:1; opacity:0.7; transparent:true"></a-box>

      <!-- Fascia rossa a parete (brand accent) -->
      <a-box position="0 0.5 -13.92" width="28" height="0.08" depth="0.05" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:0.5"></a-box>
      <a-box position="0 0.5 4.92"   width="28" height="0.08" depth="0.05" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:0.3"></a-box>
      <a-box position="-11.92 0.5 -3" width="0.05" height="0.08" depth="22" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:0.3"></a-box>
      <a-box position=" 11.92 0.5 -3" width="0.05" height="0.08" depth="22" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:0.3"></a-box>

      <!-- ═══ PIATTAFORMA ROTANTE ══════════════════════════════════════════════ -->
      <a-entity position="0 -0.5 -6" rotate-y="speed: 0.25">
        <!-- Disco piattaforma grigio lucido -->
        <a-cylinder height="0.1" radius="2.0" color="#333333" material="metalness:0.9; roughness:0.1"></a-cylinder>
        <!-- Bordo rosso -->
        <a-torus radius="2.0" radius-tubular="0.04" color="#cc0000"
          material="emissive:#cc0000; emissiveIntensity:0.8; opacity:0.9; transparent:true"
          position="0 0.05 0" rotation="90 0 0">
        </a-torus>
        <!-- Macchina centrata: position Z=-0.99 porta il centro BB a Z=0 -->
        <a-entity
          gltf-model="#auto"
          rotation="-90 90 0"
          scale="0.009 0.009 0.009"
          position="0 0.099 -0.99">
        </a-entity>
      </a-entity>

      <!-- ═══ ZONA ATTESA — sinistra ══════════════════════════════════════════ -->
      <!-- Divano angolare -->
      <a-entity gltf-model="#sofa-corner" position="-9 -0.51 -1"  rotation="0 90 0"  scale="1.5 1.5 1.5"></a-entity>
      <a-entity gltf-model="#sofa"        position="-9 -0.51 -4"  rotation="0 90 0"  scale="1.5 1.5 1.5"></a-entity>
      <!-- Tavolino davanti al divano -->
      <a-entity gltf-model="#table"       position="-7 -0.51 -2"  rotation="0 0 0"   scale="1.2 1.2 1.2"></a-entity>
      <!-- Lampada piantana -->
      <a-entity gltf-model="#lamp"        position="-10.5 -0.51 0.5" rotation="0 0 0" scale="1.3 1.3 1.3"></a-entity>
      <!-- Piante decorative -->
      <a-entity gltf-model="#plant-pot"   position="-10.5 -0.51 -7" rotation="0 45 0" scale="1.5 1.5 1.5"></a-entity>
      <a-entity gltf-model="#plant"       position="-10.5 -0.51  3"  rotation="0 20 0" scale="1.4 1.4 1.4"></a-entity>

      <!-- ═══ ZONA RECEPTION — destra ═════════════════════════════════════════ -->
      <!-- Bancone reception (semplice geometry) -->
      <a-box position="9 0.2 -2" width="5" height="1.4" depth="1.2" color="#ffffff" material="metalness:0.2; roughness:0.5"></a-box>
      <a-box position="9 0.87 -2" width="5.1" height="0.08" depth="1.3" color="#dddddd" material="metalness:0.5; roughness:0.2"></a-box>
      <!-- Fascia rossa del bancone -->
      <a-box position="9 0.0 -1.4" width="5" height="1.4" depth="0.04" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:0.2"></a-box>
      <!-- Scrivania + sedia dietro il bancone -->
      <a-entity gltf-model="#desk"       position="9.5 -0.51 -3.5" rotation="0 180 0" scale="1.2 1.2 1.2"></a-entity>
      <a-entity gltf-model="#desk-chair" position="9.5 -0.51 -3.0" rotation="0 180 0" scale="1.0 1.0 1.0"></a-entity>
      <!-- Schermo sul bancone -->
      <a-box position="8 0.95 -1.6" width="0.8" height="0.5" depth="0.05" color="#111111"></a-box>
      <a-plane position="8 0.95 -1.57" width="0.72" height="0.42" material="color:#1a3a6a; opacity:1" rotation="0 0 0"></a-plane>
      <!-- Pianta decorativa reception -->
      <a-entity gltf-model="#plant-pot" position="11.5 -0.51 -1" rotation="0 0 0" scale="1.3 1.3 1.3"></a-entity>

      <!-- ═══ PIANTE ANGOLI SHOWROOM ══════════════════════════════════════════ -->
      <a-entity gltf-model="#plant-pot" position="-11.5 -0.51 -13" rotation="0 30 0"  scale="2 2 2"></a-entity>
      <a-entity gltf-model="#plant-pot" position=" 11.5 -0.51 -13" rotation="0 -30 0" scale="2 2 2"></a-entity>
      <a-entity gltf-model="#plant"     position="-11.5 -0.51  4"  rotation="0 0 0"   scale="1.8 1.8 1.8"></a-entity>
      <a-entity gltf-model="#plant"     position=" 11.5 -0.51  4"  rotation="0 0 0"   scale="1.8 1.8 1.8"></a-entity>

      <!-- ═══ CAMERA + CURSORE ════════════════════════════════════════════════ -->
      <a-entity camera look-controls="pointerLockEnabled: false" position="0 1.6 0">
        <a-cursor
          fuse="false"
          raycaster="objects: .gaze-target; far: 14"
          geometry="primitive: ring; radiusInner: 0.012; radiusOuter: 0.018"
          material="color: #333333; shader: flat; opacity: 0.8">
        </a-cursor>
      </a-entity>

      <!-- ═══ PANNELLI GAZE ════════════════════════════════════════════════════ -->

      <!-- P1 — sinistra, ROSSO brand -->
      <a-entity position="-2.5 1.6 -1.5" rotation="0 60 0">
        <a-text value="TITOLO 1" align="center" color="#cc0000" width="2.4" position="0 0.52 0" wrap-count="18"></a-text>
        <a-box position="0 0.32 0" width="0.85" height="0.012" depth="0.005" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:0.8"></a-box>
        <a-plane id="t1" class="gaze-target" width="1.9" height="1.2" position="0 0 0" material="opacity:0; transparent:true; side:double"></a-plane>
        <a-entity id="b1" gaze-body>
          <a-plane width="1.7" height="0.72" position="0 -0.12 -0.005" material="color:#1a0000; opacity:0.93; transparent:true; side:double"></a-plane>
          <a-box position=" 0.84 -0.12 0" width="0.025" height="0.72" depth="0.008" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:1"></a-box>
          <a-box position="-0.84 -0.12 0" width="0.025" height="0.72" depth="0.008" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:1"></a-box>
          <a-box position="0  0.245 0" width="1.7" height="0.025" depth="0.008" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:1"></a-box>
          <a-box position="0 -0.485 0" width="1.7" height="0.025" depth="0.008" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:1"></a-box>
          <a-text value="Inserisci qui il tuo testo." align="center" color="#ffcccc" width="1.5" position="0 -0.12 0.01" wrap-count="30"></a-text>
        </a-entity>
      </a-entity>

      <!-- P2 — destra, GRIGIO scuro -->
      <a-entity position="2.5 1.6 -1.5" rotation="0 -60 0">
        <a-text value="TITOLO 2" align="center" color="#333333" width="2.4" position="0 0.52 0" wrap-count="18"></a-text>
        <a-box position="0 0.32 0" width="0.85" height="0.012" depth="0.005" color="#444444" material="emissive:#444444; emissiveIntensity:0.5"></a-box>
        <a-plane id="t2" class="gaze-target" width="1.9" height="1.2" position="0 0 0" material="opacity:0; transparent:true; side:double"></a-plane>
        <a-entity id="b2" gaze-body>
          <a-plane width="1.7" height="0.72" position="0 -0.12 -0.005" material="color:#1a1a1a; opacity:0.93; transparent:true; side:double"></a-plane>
          <a-box position=" 0.84 -0.12 0" width="0.025" height="0.72" depth="0.008" color="#888888" material="emissive:#888888; emissiveIntensity:0.8"></a-box>
          <a-box position="-0.84 -0.12 0" width="0.025" height="0.72" depth="0.008" color="#888888" material="emissive:#888888; emissiveIntensity:0.8"></a-box>
          <a-box position="0  0.245 0" width="1.7" height="0.025" depth="0.008" color="#888888" material="emissive:#888888; emissiveIntensity:0.8"></a-box>
          <a-box position="0 -0.485 0" width="1.7" height="0.025" depth="0.008" color="#888888" material="emissive:#888888; emissiveIntensity:0.8"></a-box>
          <a-text value="Inserisci qui il tuo testo." align="center" color="#dddddd" width="1.5" position="0 -0.12 0.01" wrap-count="30"></a-text>
        </a-entity>
      </a-entity>

      <!-- P3 — dietro-sinistra, ROSSO -->
      <a-entity position="-2.0 1.6 1.5" rotation="0 120 0">
        <a-text value="TITOLO 3" align="center" color="#cc0000" width="2.4" position="0 0.52 0" wrap-count="18"></a-text>
        <a-box position="0 0.32 0" width="0.85" height="0.012" depth="0.005" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:0.8"></a-box>
        <a-plane id="t3" class="gaze-target" width="1.9" height="1.2" position="0 0 0" material="opacity:0; transparent:true; side:double"></a-plane>
        <a-entity id="b3" gaze-body>
          <a-plane width="1.7" height="0.72" position="0 -0.12 -0.005" material="color:#1a0000; opacity:0.93; transparent:true; side:double"></a-plane>
          <a-box position=" 0.84 -0.12 0" width="0.025" height="0.72" depth="0.008" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:1"></a-box>
          <a-box position="-0.84 -0.12 0" width="0.025" height="0.72" depth="0.008" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:1"></a-box>
          <a-box position="0  0.245 0" width="1.7" height="0.025" depth="0.008" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:1"></a-box>
          <a-box position="0 -0.485 0" width="1.7" height="0.025" depth="0.008" color="#cc0000" material="emissive:#cc0000; emissiveIntensity:1"></a-box>
          <a-text value="Inserisci qui il tuo testo." align="center" color="#ffcccc" width="1.5" position="0 -0.12 0.01" wrap-count="30"></a-text>
        </a-entity>
      </a-entity>

      <!-- P4 — dietro-destra, GRIGIO -->
      <a-entity position="2.0 1.6 1.5" rotation="0 -120 0">
        <a-text value="TITOLO 4" align="center" color="#333333" width="2.4" position="0 0.52 0" wrap-count="18"></a-text>
        <a-box position="0 0.32 0" width="0.85" height="0.012" depth="0.005" color="#444444" material="emissive:#444444; emissiveIntensity:0.5"></a-box>
        <a-plane id="t4" class="gaze-target" width="1.9" height="1.2" position="0 0 0" material="opacity:0; transparent:true; side:double"></a-plane>
        <a-entity id="b4" gaze-body>
          <a-plane width="1.7" height="0.72" position="0 -0.12 -0.005" material="color:#1a1a1a; opacity:0.93; transparent:true; side:double"></a-plane>
          <a-box position=" 0.84 -0.12 0" width="0.025" height="0.72" depth="0.008" color="#888888" material="emissive:#888888; emissiveIntensity:0.8"></a-box>
          <a-box position="-0.84 -0.12 0" width="0.025" height="0.72" depth="0.008" color="#888888" material="emissive:#888888; emissiveIntensity:0.8"></a-box>
          <a-box position="0  0.245 0" width="1.7" height="0.025" depth="0.008" color="#888888" material="emissive:#888888; emissiveIntensity:0.8"></a-box>
          <a-box position="0 -0.485 0" width="1.7" height="0.025" depth="0.008" color="#888888" material="emissive:#888888; emissiveIntensity:0.8"></a-box>
          <a-text value="Inserisci qui il tuo testo." align="center" color="#dddddd" width="1.5" position="0 -0.12 0.01" wrap-count="30"></a-text>
        </a-entity>
      </a-entity>

      <script>
        window.addEventListener('load', () => {
          [['t1','b1'],['t2','b2'],['t3','b3'],['t4','b4']].forEach(([tid, bid]) => {
            const tr = document.getElementById(tid);
            const bd = document.getElementById(bid);
            tr.addEventListener('mouseenter', () => { if(bd.components['gaze-body']) bd.components['gaze-body']._t = 1; });
            tr.addEventListener('mouseleave', () => { if(bd.components['gaze-body']) bd.components['gaze-body']._t = 0; });
          });
        });
      </script>

    </a-scene>
  </body>
</html>
